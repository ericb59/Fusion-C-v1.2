<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>AY Sound FX Editor Help</title>
<style>
#txt{font-family: Arial,sans-serif;font-size:12px;color:#000000;}
#txg{font-family: Arial,sans-serif;font-size:12px;color:#505050;}
#zag{font-family: Arial,sans-serif;font-size:30px;color:#FFFFFF;}
.lfx a:hover{color:#FF0000;}
.lfx a{text-decoration:none;}
</style>
</head>

<body bgcolor=#FFFFFF text=#000000 link=#0000AF vlink=#0000AF alink=#0000AF>
<table width=100% bgcolor=#0000FF><tr><td id=zag><b>AY Sound FX Editor v0.6</b></td></tr></table>

<br><br>

<a name=conte><b id=txg>Contents</b></a><br><br>
<blockquote id=txt class=lfx>
<a href=#intro>Overview</a><br>
<a href=#iface>Interface</a><br>
<a href=#hotke>Hotkeys</a><br>
<a href=#impor>Import effects</a><br>
<a href=#expor>Export effects</a><br>
<a href=#forma>File formats</a><br>
<a href=#playe>ZX Spectrum player</a><br>
<a href=#histo>Version history</a><br>
<a href=#thank>Thanks</a><br>
<a href=#conta>Contacts</a><br>
</blockquote>
<br><br>


<p id=txt class=lfx><a href=#conte title="Back to contents"><b>^</b></a> <a name=intro><b>Overview</b></a></p>
<p id=txt class=lfx>
AY Sound FX Editor is a complete solution to create sound effects for AY-3-8910 sound chip. The effects could be used in games or other software for ZX Spectrum. It is also possible to use them with other micro computers that use the AY-3-8910. The package includes cross editor itself (a Windows software), an example of simple sound effects player with Z80 assembly source code, compiled example, and a library of sound effects.
<br><br>
The editor allows to create single channel sound effects with duration up to 4096 TV frames. Frame duration is 1/50s, so maximum effect duration is about 80 seconds. Volume, noise and mixer settings can be changed every frame. Data is stored in a compact format that omits repeating values. Effects are combined into banks, up to 256 effects. Effects player works with a bank, an effect is played using its order number in the bank.
<br><br>
It should be noted that the editor can't create effects on its own, it only allows to edit AY registers data in easy way. It is quite similar to the sample editors in AY music trackers. You have to know how the AY sound chip works in order to get desired results. However, the editor allows to import data from various formats, that could make things easier.
</p><br><br>

<p id=txt class=lfx><a href=#conte title="Back to contents"><b>^</b></a> <a name=iface><b>Interface</b></a></p>
<p id=txt class=lfx>
Program interface is all-english. There is main menu at the top of the window. The items:
</p>
<blockquote id=txt class=lfx>
File
<blockquote id=txt class=lfx>
New bank - Clear effects bank, create one empty effect;<br>
Load bank - Load effects bank from file;<br>
Save bank - Save effects bank into file;<br>
Save bank w/o names - Save effects bank into file without effect names;<br><br>
Clear current effect - Clear current effect;<br>
Load current effect - Load single effect file as current effect;<br>
Save current effect - Save current effect into single effect file;<br><br>
Multi-load to bank - Append a number of single effect files to end of the bank, starting from last empty effect;<br>
Multi-save from bank - Save all effects from bank into separate single effect files. Names will be taken from effect names, all effects will be stored in the selected folder;<br><br>
Exit - Exit from the editor.<br>
</blockquote>
Edit
<blockquote id=txt class=lfx>
Cut - Cut selected frames from effect and put them into the clipboard. For this and the next action, when there is no selection, current frame will be used (the one under the cursor);<br>
Copy - Copy selected frames into the clipboard, they will get deselected after this action;<br>
Paste - Paste the clipboard contents into the cursor position, current and subsequent frames will be shifted down;<br>
Delete - Delete selected frames;<br><br>
Select all - Select all frames that contain actual data;<br>
Unselect all - Remove selection;<br>
Inverse selection - Invert selection.<br>
</blockquote>
View
<blockquote id=txt class=lfx>
Piano input - Show/hide virtual piano window (see <a href=#piano>below</a>);<br>
Linear period - Display tone values in linear scale (irregular spread of actual frequences);<br>
Logarithmic period - Display tone values in logarithmic scale.<br>
</blockquote>
Bank
<blockquote id=txt class=lfx>
Add new effect - Append a new effect to the end of the bank and make it current;<br>
Delete effect - Delete current effect from the bank;<br>
Insert new effect - Insert a new effect in place of current, the current and all subsequent will be shifted.<br>
</blockquote>
Import (see <a href=#impor>Import effects</a>)
<blockquote id=txt class=lfx>
PSG for AY - Improt from PSG;<br>
VTX file - Import from VTX;<br>
VGM file - Import from VGM;<br>
Wave file - Import from WAV.<br>
</blockquote>
Export (see <a href=#expor>Export effects</a>)
<blockquote id=txt class=lfx>
VTII Sample - Export as Vortex Tracker II instrument;<br>
Wave file - Export as WAV file;<br>
CSV - Export as text-based CSV file.<br>
</blockquote>
</blockquote>
<p id=txt class=lfx>
<br>
Below the main menu there is a bar with a number of controls. When you hover the mouse above them, a hint is displayed.
<br><br>
At the left of the bar there are three buttons. Play and Stop perform corresponding actions with the current effect. The button with the piano keys shows or hides the virtual piano window (see <a href=#piano>below</a>).
<br><br>
At the right of the bar there are bank controls. [Add] appends an effect to the end of the bank. [Del] deletes current effect. Next four buttons with two numbers (current effect and total number of effects in bank) in between are to navigate between effects. Double arrows are to go to the first and the last effect in the bank. Last in the bar there is effect name. You can edit it by clicking it with left mouse button, entering a new name, and pressing Enter to confirm changes. Some hotkeys won't work while the name editor is active.
<br><br><br>
All remaining space of the program window is the effect editor. You can use either mouse or keyboard to edit values. There are few columns. Pos is frame number. You can select frames with LMB on the frame number or deselect them with RMB. T, N are the AY mixer bits, edited similar to the selection. Per is the tone period. Ns is the noise period. V is the volume. When you click on any of Per, NS or V value, cursor moves to the frame. In the right part of the window the same values are represented in graphic form, they can also be edited using mouse buttons. When the Ctrl button is held down, mouse won't move horizontally, allowing easier drawing a sequence of the same values.
<br><br>
The editor window can be resized vertically with one frame step, but can not be resized horizontally.
<br><br><br>
<a name=piano></a>
There is a special window to simplify creation of sound effects based on musical notes. It can be brought with the button with piano keys or through View->Piano Input item of the main menu. At the left part of the window there is a hint which keyboard buttons correspond to notes. At the right there are controls that affect to the input. The Octave field sets up the current octave (1...8). The Step field sets up the number of frames that the cursor will advance after entering a note. The Fill field sets up how many subsequent frames will be set to the same value with a single note input. The Link button links Step and Fill fields, matching up the fill value to the step. When the Set T button is down, T flag is set for frame at note input, when it is up, existing T value of a frame won't be changed. Set Volume does the same for volume column, entering value that can be changed at the right of the button.
</p><br><br>


<p id=txt class=lfx><a href=#conte title="Back to contents"><b>^</b></a> <a name=hotke><b>Hotkeys</b></a></p>
<p id=txt class=lfx>
<i>Main window</i><br><br>
<table border=0 cellspacing=2 cellpadding=1>
<tr valign=top><td width=180 bgcolor=#d0d0d0>Cursor Up/Down</td><td bgcolor=#f5f5f5>Go to the previous/next frame.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Cursor Left/Right</td><td bgcolor=#f5f5f5>Switch between tone/noise/volume columns.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>0-9, A-F</td><td bgcolor=#f5f5f5>Enter tone/noise/volume value.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Page Up/Down</td><td bgcolor=#f5f5f5>Go a page up/down.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Mouse wheel</td><td bgcolor=#f5f5f5>Go five frames up/down.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Home</td><td bgcolor=#f5f5f5>Go to the begin of current effect (frame 0).</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>End</td><td bgcolor=#f5f5f5>Go to the end of current effect (last frame with non-zero volume).</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Mouse buttons</td><td bgcolor=#f5f5f5>On the tone/noise/volume bars - change a value, on the effect name - edit name mode.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Left Mouse Button</td><td bgcolor=#f5f5f5>On the T/N flags - set them; on a frame number - select frame.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Right Mouse Button</td><td bgcolor=#f5f5f5>On the T/N flags - reset them; on a frame number - deselect frame.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Ctrl</td><td bgcolor=#f5f5f5>Disable horizontal mouse movements inside the effect value bars.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>~</td><td bgcolor=#f5f5f5>Show/hide the piano input window.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Enter</td><td bgcolor=#f5f5f5>In the effect edit mode - play current effect; in the name edit mode - go to the effect edit mode.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Ctrl+Enter</td><td bgcolor=#f5f5f5>Play effect starting from current frame.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Space</td><td bgcolor=#f5f5f5>Stop playing.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Delete</td><td bgcolor=#f5f5f5>Delete selection, selected frames will be removed, remaining will be shifted. When there is no selection, current frame will be deleted.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Insert</td><td bgcolor=#f5f5f5>Insert an empty frame, current and subsequent frames will be shifted down.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Ctrl+Insert</td><td bgcolor=#f5f5f5>Clone current frame, subsequent frames will be shifted down.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>T</td><td bgcolor=#f5f5f5>Toggle T flag for the current frame.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>N</td><td bgcolor=#f5f5f5>Toggle N flag for the current frame.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Ctrl+A</td><td bgcolor=#f5f5f5>Select the whole actual effect, from start to last frame with non-zero volume.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Ctrl+I</td><td bgcolor=#f5f5f5>Invert selection in the actual effect frames.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Ctrl+X</td><td bgcolor=#f5f5f5>Cut frames into the clipboard.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Ctrl+C</td><td bgcolor=#f5f5f5>Copy frames into the clipboard, selection will be reset.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Ctrl+V</td><td bgcolor=#f5f5f5>Paste the clipboard content into the cursor position, current and subsequent frames will be shifted down.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>[+] or Numpad [+]</td><td bgcolor=#f5f5f5>Go to the next effect.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>[-] or Numpad [-]</td><td bgcolor=#f5f5f5>Go to the previous effect.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Shift+[+] or Shift+Numpad [+]</td><td bgcolor=#f5f5f5>Increase tone, noise, or volume value by 1.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Shift+[-] or Shift+Numpad [-]</td><td bgcolor=#f5f5f5>Decrease tone, noise, or volume value by 1.</td></tr>
</table>
<br><br>
<i>Piano window</i><br><br>
<table border=0 cellspacing=2 cellpadding=1>
<tr valign=top><td width=180 bgcolor=#d0d0d0>Z,S,X,D,C,V,G,B,H,N,J,M</td><td bgcolor=#f5f5f5>Note keys, input notes in range of current octave.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Shift+Note key</td><td bgcolor=#f5f5f5>Input note one octave higher.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Ctrl+Note key</td><td bgcolor=#f5f5f5>Input note one octave below.</td></tr>
<tr valign=top><td bgcolor=#d0d0d0>Numpad 1...8</td><td bgcolor=#f5f5f5>Change current octave.</td></tr>
</table>
</p><br><br>


<p id=txt class=lfx><a href=#conte title="Back to contents"><b>^</b></a> <a name=impor><b>Import effects</b></a></p>
<p id=txt class=lfx>
Following file formats are supported.
<br><br>
<i>PSG</i>
<br><br>
AY registers dump. Files with complete 16-byte header are supported. These files could be created with AY Emulator or Z80Stealth. You can select channel that will be source of data before import. Auto option will select the channel where the volume changes first, with automatic skip of the pause before. Tone, noise, volume, and mixer settings of selected channel will be imported. To simplify things, it is better to use source files with single channel effects.
<br><br>
<i>VTX</i>
<br><br>
AY registers dump. These files could be created with AY Emulator and UnrealSpeccy. Import options are the same as for PSG.
<br><br>
<i>VGM</i>
<br><br>
Registers dump for SN76489 or compatibles, the sound chip that has been used in Master System, Game Gear, Sega Genesis, ColecoVision, and some other computers or game consoles. The imported data is adapted to get similar sound, but as the chip capabilities are quite different, there will be difference.
<br><br>
<i>WAV</i>
<br><br>
Only standard, unpacked PCM files supported, of any sample rate, bits depth, mono or stereo. Volume envelope gets imported, tone pitch gets analyzed. If it is possible to detect pitch for a frame, T flag sets along with the pitch value, otherwise N flag sets.
<br><br>
</p>



<p id=txt class=lfx><a href=#conte title="? ??????????"><b>^</b></a> <a name=expor><b>Export effects</b></a></p>
<p id=txt class=lfx>
Following file formats are supported.
<br><br>
<i>VTII Instrument</i>
<br><br>
Vortex Tracker II instrument, which is a plain text file. Export dialogs allows to set a base note that should be used to get original pitch in the tracker.
<br><br>
<i>WAV</i>
<br><br>
Standard uncompressed PCM file, 44100 Hz, 16 bit, mono.
<br><br>
<i>CSV</i>
<br><br>
Comma separated values in a text file. Can be handy for further parsing and processing with external tools.
<br><br>
<i>Current effect</i>
<br><br>
When this item is checked, export functions will export current effect only, under specified filename.
<br><br>
<i>All effects</i>
<br><br>
When this item is checked, export functions will export all effects from the bank. The filename can have an optional prefix with effect number and name, this can be selected as the file type in the export dialog.
<br><br>
</p>



<p id=txt class=lfx><a href=#conte title="Back to contents"><b>^</b></a> <a name=forma><b>File formats</b></a></p>
<p id=txt class=lfx>
16-bit numbers stored in the LSB,MSB format.<br><br>
<i>Single effect, file extension .afx</i>
<br><br>
Every frame encoded with a flag byte and a number of bytes, which is vary depending from value change flags.
</p>
<pre>
 bit0..3  Volume
 bit4     Disable T
 bit5     Change Tone
 bit6     Change Noise
 bit7     Disable N
</pre>
<p id=txt class=lfx>
When the bit5 set, two bytes with tone period will follow; when the bit6 set, a single byte with noise period will follow; when both bits are set, first two bytes of tone period, then single byte with noise period will follow. When none of the bits are set, next flags byte will follow.
<br><br>
End of the effect is marked with byte sequence #D0, #20. Player should detect it before outputting it to the AY registers, by checking noise period value to be equal #20. The editor considers last non-zero volume value as the last frame of an effect, other parameters aren't matter.
<br><br>

<i>Effects bank, file extension .afb</i>
<br><br>
Header:
<br><br>
+0 (1 byte) Total number of effects in the bank, up to 256 (0 means 256);<br>
+1 (2 bytes per effect) Table of offsets to data of every effect. Offset value is given relative to the second byte of the offset itself, this allows to calculate absolute address very fast:
<br><br>
</p>
<pre>
   hl=offset in the effects table
   ld c,(hl)
   inc hl
   ld b,(hl)
   add hl,bc
   hl=absolute address of effect data
</pre>
<p id=txt class=lfx>
Data:
<br><br>
+n (m bytes) The effects data, format is the same as in the single effect file. After every effect there could be a null terminated text string with name of the effect. It may absent, if the bank was saved into a file using corresponding item of the File menu, in this case null terminator bytes are absent as well.
</p><br><br>

<p id=txt class=lfx><a href=#conte title="Back to contents"><b>^</b></a> <a name=playe><b>ZX Spectrum player</b></a></p>
<p id=txt class=lfx>
The package includes a simple sound effects player. It is located at /z80player/ayfxplay.a80. This file is a text file with Z80 source code for asm80 cross assembler. There are comments on use and internals as well.
<br><br>
The player can play effects using all three AY channels. When there is an empty (not playing) channel, it will be used, otherwise the one that was active for longest time will be used. AY music can't play while this version of the player is active.
<br><br>
Besides the player, there is an example program, available as compiled SCL disk image and source code. All keys has sound effects assigned to them. Space key turns on/off music that is played on the second sound chip of TurboSound device (NedoPC version), if it is available. If the TurboSound is absent, music will play on the same chip, producing various sound artefacts.
</p>
<br><br>

<p id=txt class=lfx><a href=#conte title="Back to contents"><b>^</b></a> <a name=histo><b>Version history</b></a></p>
<p id=txt class=lfx>
v0.6 01.02.17<br>
v0.5, v0.51, v0.52 unreleased during 2006-2017<br>
v0.4 09.05.06<br>
v0.3 28.02.06<br>
v0.2 12.02.06<br>
v0.1 02.02.06<br>
</p><br><br>


<p id=txt class=lfx><a href=#conte title="Back to contents"><b>^</b></a> <a name=thank><b>Thanks</b></a></p>
<p id=txt class=lfx>
Thanks goes to:
<i>Alone Coder</i>, for help with the project;<br>
<i>Sergey Bulba</i>, for AY Emulator, Vortex Tracker, and various docs at his webpage;<br>
<i>SMT</i>, for UnrealSpeccy and open source VTX format player;<br>
<i>Copper Feet</i>, for asm80 cross assembler;<br>
Also thanks to authors of the sound effects that are included into the library.<br>
</p><br><br>


<p id=txt class=lfx><a href=#conte title="Back to contents"><b>^</b></a> <a name=conta><b>Contacts</b></a></p>
<p id=txt class=lfx>
You can send bug reports, suggestions, or sound effects to include into the bundled library, at <a href="mailto:shiru@mail.ru?subject=AY Sound FX Editor">shiru@mail.ru</a>
</p>
</body>
</html>